@startuml
title Private Kubernetes Cluster with FritzBox VPN + MetalLB

actor "Developer / Admin" as user

rectangle "Home Network (LAN)" {
    node "FritzBox Router" as fritz {
        artifact "VPN Server\n(IPSec / WireGuard)" as vpn
        note right of vpn
            Provides secure access
            to internal network.
        end note
    }

    frame "Kubernetes Cluster (Private)" {
        node "Node 1 (Master / Gateway)" as node1 {
            component "Kube-API Server" as api
            component "Ingress Controller" as ingress
        }
        node "Node 2 (Worker)" as node2 {
            component "Backend Pods" as backend
            component "Database" as db
        }

        cloud "MetalLB" as metallb
        note right of metallb
            Allocates private IPs
            (e.g., 192.168.178.240â€“250)
            for Services of type LoadBalancer.
        end note

        node1 -[hidden]-> node2
        ingress --> backend
        backend --> db
        metallb --> ingress
    }

    component "Internal CA (cert-manager + self-signed)" as ca
    ca -down-> ingress : Issues internal TLS certs
}

user -[#blue]-> vpn : Connect via VPN (FritzBox)
vpn -[#blue]-> ingress : Access internal HTTPS\n(e.g. https://dashboard.local)
vpn -[#blue]-> backend : API access via ClusterIP\n(e.g. https://api.local)
@enduml
